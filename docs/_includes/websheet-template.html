---
layout: "default"
hide-details: false
---

{% comment %}
Try to eat up all leading slashes and the trailing .html .
This is gross but it works.
{% endcomment %}
{% assign ward-id = page.url | replace: '.html', '' | split: '/' | last -%}
{% assign ward-info = site.data.internal.position-tags |
where:"PositionUniqueName",ward-id | first -%}

<h1><span class="print-hidden">Who is Running? </span>{{ ward-info.PositionDesc }}</h1>


{% assign municipal-info = site.data.internal.municipality-map |
  where:"Name",ward-info.WardMunicipality | first %}
{% assign races-split = municipal-info.Races | split: ',' %}

<div class="flex gutters">

<link rel="stylesheet" href="../assets/css/worksheet.css">

<div class="worksheet-container">
  <div class="worksheet-controls">
    <button class="control-btn" id="export-btn">Export CSV</button>
    <button class="control-btn" id="import-btn">Import CSV</button>
    <input type="file" id="import-file" style="display: none" accept=".csv">
  </div>

  {% for race in races-split %}
    {% if race == "_SELF" %}
      {% assign race-id = ward-id %}

    {% else %}
      {% assign race-id = race %}
    {% endif %}

    {% assign race-info = site.data.internal.position-tags | where:"PositionUniqueName",race-id | first %}
    
    <div class="worksheet-race-section" id="{{ race-id }}">
      <h2 class="worksheet-race-title">{{ race-info.PositionDesc }}</h2>
      
      {% assign these-nominees = site.data.sync.nominees | where:"PositionUniqueName",race-id | sort:"Last_Name" %}
      
      {% if these-nominees.size > 0 %}
        <div class="worksheet-nominees-list">
          {% for nominee in these-nominees %}
            <div class="worksheet-nominee-item">
              <div class="nominee-header">
                <span class="nominee-name">{{ nominee.Given_Names }} {{ nominee.Last_Name }} <span nominee-id="{{ race-info.PositionDesc }}-{{ nominee.Given_Names }}-{{ nominee.Last_Name }}" class="print-hidden"></span></span>
                <div class="emoji-selector print-hidden" nominee-id="{{ race-info.PositionDesc }}-{{ nominee.Given_Names }}-{{ nominee.Last_Name }}">
                  <span class="emoji-selector-button">üëå</span>
                  <span class="emoji-selector-button">üëç</span>
                  <span class="emoji-selector-button">‚ùì</span>
                  <span class="emoji-selector-button">üëé</span>
                </div>
              </div>
              <textarea 
                class="worksheet-note-area" 
                data-nominee-id="{{ nominee.UniqueID }}"
                data-nominee-name="{{ nominee.Given_Names }} {{ nominee.Last_Name }}"
                placeholder="Write your notes here..."></textarea>
            </div>
          {% endfor %}
        </div>
      {% else %}
        <p class="no-nominees">No nominees found for this race.</p>
      {% endif %}
    </div>
  {% endfor %}
</div>

<script src="../assets/js/worksheet.js"></script>

</div>
